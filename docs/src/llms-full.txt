# fmm — Frontmatter Matters (Full Documentation)

> This file contains the complete fmm documentation in a single file,
> suitable for ingestion by LLM agents. Generated from source docs.

---

# Introduction

**fmm** (Frontmatter Matters) generates `.fmm` sidecar files alongside your source code. Each sidecar is a small YAML file listing the exports, imports, dependencies, and line count of its companion source file.

LLM agents use these sidecars to navigate codebases without reading every source file — reducing token usage by 80-90% while maintaining full structural awareness.

## Why sidecars?

When an LLM agent needs to understand your codebase, it typically reads every source file — consuming tens of thousands of tokens. With fmm sidecars, the agent reads compact metadata instead:

| Approach | Tokens for 500-file project |
|----------|---------------------------|
| Read all source files | ~50,000 tokens |
| Read fmm sidecars | ~2,000 tokens |

That's a **96% reduction** in context usage, with zero loss of navigational capability.

## How it works

1. **Generate** — fmm parses your source files using tree-sitter ASTs and writes `.fmm` sidecar files
2. **Navigate** — LLM agents read sidecars to understand file structure, then open only the files they need
3. **Search** — O(1) reverse-index lookups find which file exports any symbol

## Supported languages

TypeScript, JavaScript, Python, Rust, Go, Java, C++, C#, Ruby

## Quick start

```bash
cargo install fmm
cd your-project
fmm init
```

That's it. Your AI assistant now navigates via metadata.

---

# Installation

## From crates.io

```bash
cargo install fmm
```

## From source

```bash
git clone https://github.com/mdcontext/fmm
cd fmm
cargo install --path .
```

## Verify installation

```bash
fmm --version
```

## Shell completions

Generate tab-completion scripts for your shell:

```bash
# Bash
fmm completions bash > ~/.local/share/bash-completion/completions/fmm

# Zsh
fmm completions zsh > ~/.zfunc/_fmm

# Fish
fmm completions fish > ~/.config/fish/completions/fmm.fish

# PowerShell
fmm completions powershell > _fmm.ps1
```

---

# Quickstart

Get your first sidecar in 60 seconds.

## 1. Initialize

```bash
cd your-project
fmm init
```

This creates config files and generates sidecars in one step. You'll see output like:

```
Frontmatter Matters — metadata sidecars for LLM code navigation

✓ Created .fmmrc.json with default configuration
✓ Installed Claude skill at .claude/skills/fmm-navigate.md
✓ Created .mcp.json with fmm server configuration

✓ 247 source files detected (ts, py, rs)
Generating sidecars...
Found 247 files to process
✓ src/auth.ts.fmm
✓ src/db.ts.fmm
...
✓ 247 sidecar(s) written

Sample sidecar for src/auth.ts:
  ---
  file: src/auth.ts
  exports: [authenticate, createSession, validateToken]
  imports: [jsonwebtoken, bcrypt]
  dependencies: [./db, ./config]
  loc: 142
  ---

  next: Try: fmm search --export authenticate

Setup complete!
  Config:   .fmmrc.json
  Skill:    .claude/skills/fmm-navigate.md
  MCP:      .mcp.json

  ✓ Your AI assistant now navigates this codebase via metadata sidecars
```

## 2. Search

Find where a symbol is defined:

```bash
fmm search --export createStore
```

```
✓ 1 file(s) found:

src/store/index.ts
  exports: createStore, configureStore, StoreConfig
  imports: redux, immer
  loc: 89
```

## 3. Validate in CI

Add to your CI pipeline to ensure sidecars stay current:

```bash
fmm validate
```

Returns exit code 0 if all sidecars match their source files, 1 if any are stale.

## What's in a sidecar?

Each `.fmm` file contains:

- **file** — relative path to the source file
- **exports** — public symbols (functions, classes, types, constants)
- **imports** — external package imports
- **dependencies** — relative file dependencies within the project
- **loc** — line count

This is enough for an LLM to navigate your entire codebase without reading source files.

## Next steps

- [CLI Reference](../reference/cli.md) — all commands and options
- [Sidecar Format](../reference/sidecar-format.md) — full YAML specification
- [Configuration](../reference/configuration.md) — `.fmmrc.json` options

---

# Command-Line Help for `fmm`

This document contains the help content for the `fmm` command-line program.

**Command Overview:**

* [`fmm`↴](#fmm)
* [`fmm generate`↴](#fmm-generate)
* [`fmm update`↴](#fmm-update)
* [`fmm validate`↴](#fmm-validate)
* [`fmm clean`↴](#fmm-clean)
* [`fmm init`↴](#fmm-init)
* [`fmm status`↴](#fmm-status)
* [`fmm search`↴](#fmm-search)
* [`fmm mcp`↴](#fmm-mcp)
* [`fmm completions`↴](#fmm-completions)
* [`fmm gh`↴](#fmm-gh)
* [`fmm gh issue`↴](#fmm-gh-issue)
* [`fmm compare`↴](#fmm-compare)

## `fmm`

Frontmatter Matters (fmm) generates .fmm sidecar files alongside your source code. Each sidecar is a small YAML file listing the exports, imports, dependencies, and line count of its companion source file.

LLM agents use these sidecars to navigate codebases without reading every source file — reducing token usage by 80-90% while maintaining full structural awareness.

Supports: TypeScript, JavaScript, Python, Rust, Go, Java, C++, C#, Ruby

Core Commands
  generate      Create .fmm sidecar files for source files
  update        Regenerate all .fmm sidecars from source
  validate      Check sidecars are up to date (CI-friendly)
  clean         Remove all .fmm sidecar files

Setup
  init          Initialize fmm in this project (config, skill, MCP)
  status        Show current fmm status and configuration
  completions   Generate shell completions (bash, zsh, fish, powershell)

Integration
  mcp           Start MCP server for LLM tool integration
  gh            GitHub integrations (issue fixing, PR creation)

Analysis
  search        Query sidecars by export, import, dependency, or LOC
  compare       Benchmark FMM vs control on a GitHub repository


**Usage:** `fmm [COMMAND]`

Examples

  $ fmm init
    Set up config, Claude skill, and MCP server in one step

  $ fmm generate
    Create .fmm sidecars for all source files in the current directory

  $ fmm generate src/
    Generate sidecars for a specific directory only

  $ fmm search --export createStore
    Find which file defines a symbol (O(1) lookup via reverse index)

  $ fmm search --loc ">500"
    Find large files (over 500 lines)

  $ fmm validate
    Check all sidecars are current — great for CI pipelines

Learn more

  https://github.com/mdcontext/fmm

###### **Subcommands:**

* `generate` — Create .fmm sidecar files for source files
* `update` — Regenerate all .fmm sidecars from source
* `validate` — Check sidecars are up to date (CI-friendly)
* `clean` — Remove all .fmm sidecar files
* `init` — Initialize fmm in this project (config, skill, MCP)
* `status` — Show current fmm status and configuration
* `search` — Query sidecars by export, import, dependency, or LOC
* `mcp` — Start MCP server for LLM tool integration
* `completions` — Generate shell completions for bash, zsh, fish, or powershell
* `gh` — GitHub integrations (issue fixing, PR creation)
* `compare` — Benchmark FMM vs control on a GitHub repository



## `fmm generate`

Create .fmm sidecar files for source files that don't already have them.

Each sidecar captures the file's exports, imports, dependencies, and line count in a compact YAML format. Existing sidecars are left untouched — use 'update' to refresh them.

**Usage:** `fmm generate [OPTIONS] [PATH]`

Examples

  $ fmm generate
    Generate sidecars for all supported files in the current directory

  $ fmm generate src/
    Generate sidecars for a specific directory

  $ fmm generate -n
    Dry run — show what would be created without writing files

###### **Arguments:**

* `<PATH>` — Path to file or directory

  Default value: `.`

###### **Options:**

* `-n`, `--dry-run` — Show what would be created without writing files



## `fmm update`

Regenerate all .fmm sidecar files from their source files.

Unlike 'generate' which skips existing sidecars, 'update' overwrites every sidecar with fresh metadata. Use after refactoring or when sidecars may be stale.

**Usage:** `fmm update [OPTIONS] [PATH]`

Examples

  $ fmm update
    Refresh all sidecars in the current directory

  $ fmm update src/ -n
    Preview which sidecars would change

###### **Arguments:**

* `<PATH>` — Path to file or directory

  Default value: `.`

###### **Options:**

* `-n`, `--dry-run` — Show what would be changed without writing files



## `fmm validate`

Validate that all .fmm sidecars match their source files.

Returns exit code 0 if all sidecars are current, or 1 if any are stale or missing. Designed for CI pipelines — add to your pre-commit hooks or GitHub Actions.

**Usage:** `fmm validate [PATH]`

Examples

  $ fmm validate
    Check all sidecars in the current directory

  $ fmm validate src/
    Check a specific directory

###### **Arguments:**

* `<PATH>` — Path to file or directory

  Default value: `.`



## `fmm clean`

Remove all .fmm sidecar files and the legacy .fmm/ directory.

Use this to cleanly uninstall fmm from a project or to start fresh.

**Usage:** `fmm clean [OPTIONS] [PATH]`

Examples

  $ fmm clean
    Remove all sidecars in the current directory

  $ fmm clean -n
    Preview what would be removed

###### **Arguments:**

* `<PATH>` — Path to file or directory

  Default value: `.`

###### **Options:**

* `-n`, `--dry-run` — Show what would be removed without deleting files



## `fmm init`

Set up fmm in the current project.

Creates .fmmrc.json config, installs the Claude Code skill for sidecar-aware navigation, and configures the MCP server in .mcp.json. Run with no flags for the full setup, or use --skill/--mcp to install individual components.

**Usage:** `fmm init [OPTIONS]`

Examples

  $ fmm init
    Full setup — config, skill, and MCP server

  $ fmm init --skill
    Install only the Claude Code navigation skill

  $ fmm init --mcp
    Install only the MCP server configuration

###### **Options:**

* `--skill` — Install Claude Code skill only (.claude/skills/fmm-navigate.md)
* `--mcp` — Install MCP server config only (.mcp.json)
* `--all` — Install all integrations (non-interactive)
* `--no-generate` — Skip auto-generating sidecars (config files only)



## `fmm status`

Display the current fmm configuration, supported languages, and workspace statistics including source file and sidecar counts.

**Usage:** `fmm status`



## `fmm search`

Search sidecar metadata to find files by export name, import path, dependency, or line count.

Export lookups use a reverse index for O(1) performance. Filters can be combined. With no filters, lists all indexed files.

**Usage:** `fmm search [OPTIONS]`

Examples

  $ fmm search --export createStore
    Find which file defines 'createStore'

  $ fmm search --imports react
    Find all files that import from 'react'

  $ fmm search --loc ">500"
    Find files over 500 lines

  $ fmm search --depends-on src/utils.ts --json
    Find dependents of a file, output as JSON

###### **Options:**

* `-e`, `--export <EXPORT>` — Find file by export name (O(1) reverse-index lookup)
* `-i`, `--imports <IMPORTS>` — Find files that import a module
* `-l`, `--loc <LOC>` — Filter files by line count.

   Supports comparison operators: >500, <100, >=50, <=1000, =200.
   A bare number is treated as exact match (=).
* `-d`, `--depends-on <DEPENDS_ON>` — Find files that depend on a path
* `-j`, `--json` — Output as JSON



## `fmm mcp`

Start the Model Context Protocol (MCP) server over stdio.

The MCP server exposes fmm's search and metadata capabilities as tools that LLM agents (Claude, GPT, etc.) can call directly. Add to .mcp.json with 'fmm init --mcp'.

**Usage:** `fmm mcp`



## `fmm completions`

Generate shell completion scripts for fmm.

Outputs a completion script for the specified shell to stdout. Redirect to the appropriate file for your shell to enable tab completion.

**Usage:** `fmm completions <SHELL>`

Examples

  $ fmm completions bash > ~/.local/share/bash-completion/completions/fmm
  $ fmm completions zsh > ~/.zfunc/_fmm
  $ fmm completions fish > ~/.config/fish/completions/fmm.fish
  $ fmm completions powershell > _fmm.ps1

###### **Arguments:**

* `<SHELL>` — Target shell

  Possible values: `bash`, `elvish`, `fish`, `powershell`, `zsh`




## `fmm gh`

GitHub workflow integrations powered by fmm sidecar metadata.

Currently supports automated issue fixing: clone a repo, generate sidecars, extract code references from the issue, and invoke Claude with focused context to create a PR.

**Usage:** `fmm gh <COMMAND>`

###### **Subcommands:**

* `issue` — Fix a GitHub issue: clone, generate sidecars, invoke Claude, create PR



## `fmm gh issue`

Automated GitHub issue fixing powered by fmm.

Pipeline: parse issue URL → fetch issue details → clone repo → generate sidecars → extract code references → resolve against sidecar index → build focused prompt → create branch → invoke Claude → commit → push → create PR.

**Usage:** `fmm gh issue [OPTIONS] <URL>`

Examples

  $ fmm gh issue https://github.com/owner/repo/issues/42
    Fix an issue and create a PR

  $ fmm gh issue https://github.com/owner/repo/issues/42 -n
    Dry run — show extracted refs and assembled prompt

  $ fmm gh issue https://github.com/owner/repo/issues/42 --no-pr
    Fix and commit but skip PR creation

###### **Arguments:**

* `<URL>` — GitHub issue URL (e.g., https://github.com/owner/repo/issues/123)

###### **Options:**

* `--model <MODEL>` — Claude model to use

  Default value: `sonnet`
* `--max-turns <MAX_TURNS>` — Maximum turns for Claude

  Default value: `30`
* `--max-budget <MAX_BUDGET>` — Maximum budget in USD

  Default value: `5.0`
* `-n`, `--dry-run` — Show plan without executing (extract refs + assembled prompt)
* `--branch-prefix <BRANCH_PREFIX>` — Git branch prefix

  Default value: `fmm`
* `--no-pr` — Commit and push only, skip PR creation
* `--workspace <WORKSPACE>` — Override workspace directory



## `fmm compare`

Run controlled comparisons of FMM-assisted vs unassisted Claude performance on a GitHub repository.

Clones the repo, generates sidecars, runs a set of coding tasks with and without FMM, and produces a report comparing token usage, cost, and quality.

**Usage:** `fmm compare [OPTIONS] <URL>`

Examples

  $ fmm compare https://github.com/owner/repo
    Run standard benchmark suite

  $ fmm compare https://github.com/owner/repo --quick
    Quick mode with fewer tasks

  $ fmm compare https://github.com/owner/repo --format json -o results/
    JSON output to a specific directory

###### **Arguments:**

* `<URL>` — GitHub repository URL (e.g., https://github.com/owner/repo)

###### **Options:**

* `-b`, `--branch <BRANCH>` — Branch to compare (default: main)
* `--src-path <SRC_PATH>` — Path within repo to analyze
* `--tasks <TASKS>` — Task set to use (standard, quick, or path to custom JSON)

  Default value: `standard`
* `--runs <RUNS>` — Number of runs per task

  Default value: `1`
* `-o`, `--output <OUTPUT>` — Output directory for results
* `--format <FORMAT>` — Output format

  Default value: `both`

  Possible values: `json`, `markdown`, `both`

* `--max-budget <MAX_BUDGET>` — Maximum budget in USD

  Default value: `10.0`
* `--no-cache` — Skip cache (always re-run tasks)
* `--quick` — Quick mode (fewer tasks, faster results)
* `--model <MODEL>` — Model to use

  Default value: `sonnet`



<hr/>

<small><i>
    This document was generated automatically by
    <a href="https://crates.io/crates/clap-markdown"><code>clap-markdown</code></a>.
</i></small>

---

# Sidecar Format

fmm sidecar files use YAML frontmatter format. Each `.fmm` file describes the metadata of its companion source file.

## File naming

Sidecars are placed alongside their source files with an `.fmm` extension appended:

```
src/auth.ts      → src/auth.ts.fmm
src/db.py        → src/db.py.fmm
src/lib.rs       → src/lib.rs.fmm
```

## Schema

```yaml
---
file: <relative-path>
exports: [<symbol>, ...]
imports: [<package>, ...]
dependencies: [<relative-path>, ...]
loc: <integer>
---
```

### Fields

| Field | Type | Description |
|-------|------|-------------|
| `file` | string | Relative path from project root to the source file |
| `exports` | string[] | Public symbols: functions, classes, types, constants, interfaces |
| `imports` | string[] | External package imports (npm packages, pip packages, crate names) |
| `dependencies` | string[] | Relative file paths this file depends on (internal imports) |
| `loc` | integer | Total lines of code in the source file |

### Language-specific custom fields

Some languages include additional metadata:

**Rust:**
```yaml
rust:
  derives: [Debug, Clone, Serialize]
  async_functions: [fetch_data, process_stream]
  unsafe_blocks: 2
  lifetimes: ['a, 'static]
  trait_impls: [Display for Config, From<String> for Error]
```

**Python:**
```yaml
python:
  decorators: [app.route, dataclass, abstractmethod]
```

## Example

For a TypeScript file `src/store/index.ts`:

```typescript
import { createSlice, configureStore } from '@reduxjs/toolkit';
import { api } from '../api/client';

export interface StoreConfig {
  debug: boolean;
}

export function createStore(config: StoreConfig) {
  return configureStore({ /* ... */ });
}

export const defaultConfig: StoreConfig = { debug: false };
```

The generated sidecar `src/store/index.ts.fmm`:

```yaml
---
file: src/store/index.ts
exports: [StoreConfig, createStore, defaultConfig]
imports: ["@reduxjs/toolkit"]
dependencies: [../api/client]
loc: 14
---
```

## What's excluded

- **Private symbols** — unexported functions, internal helpers
- **Relative imports** — captured as `dependencies`, not `imports`
- **Type-only imports** — included in `imports` (they affect the dependency graph)
- **Comments and whitespace** — not tracked, but `loc` counts all lines

## Manifest (in-memory)

When fmm loads sidecars, it builds an in-memory manifest with:
- **File index** — O(1) lookup by file path
- **Export reverse index** — O(1) lookup: "which file exports `createStore`?"
- **Full metadata** — all sidecar fields accessible per file

---

# Configuration

fmm is configured via `.fmmrc.json` in your project root. All fields are optional — sensible defaults are used when the file is missing or fields are omitted.

## Default configuration

```json
{
  "format": "yaml",
  "include_loc": true,
  "max_file_size": 500,
  "languages": [
    "ts", "tsx", "js", "jsx",
    "py",
    "rs",
    "go",
    "java",
    "cpp", "cc", "cxx", "hpp", "h",
    "cs",
    "rb"
  ]
}
```

## Fields

### `format`

**Type:** `"yaml"` | `"json"`
**Default:** `"yaml"`

Output format for sidecar files. YAML is recommended — it's more compact and readable.

### `include_loc`

**Type:** `boolean`
**Default:** `true`

Whether to include line-of-code counts in sidecars. Useful for finding large files with `fmm search --loc ">500"`.

### `max_file_size`

**Type:** `integer` (KB)
**Default:** `500`

Maximum file size in kilobytes to process. Files larger than this are skipped. Set to `0` to disable the limit.

### `languages`

**Type:** `string[]`
**Default:** all supported extensions

List of file extensions to process. Only files matching these extensions will have sidecars generated.

## Ignore files

### `.fmmignore`

Create a `.fmmignore` file (same syntax as `.gitignore`) to exclude files from sidecar generation:

```
# Skip generated code
src/generated/
*.generated.ts

# Skip vendor directories
vendor/
third_party/
```

### `.gitignore`

fmm automatically respects `.gitignore` rules. Files ignored by git are also ignored by fmm.

## MCP server configuration

The MCP server is configured in `.mcp.json`:

```json
{
  "mcpServers": {
    "fmm": {
      "command": "fmm",
      "args": ["serve"]
    }
  }
}
```

Run `fmm init --mcp` to generate this automatically.

## Claude Code skill

The Claude Code skill is installed at `.claude/skills/fmm-navigate.md`. It teaches Claude how to navigate using fmm sidecars.

Run `fmm init --skill` to install or update it.

---

# MCP Tools

fmm exposes a Model Context Protocol (MCP) server that LLM agents can call directly. Start it with `fmm mcp` or configure it in `.mcp.json` via `fmm init --mcp`.

## Tools

### `fmm_lookup_export`

Instant O(1) symbol-to-file lookup. Find where a function, class, type, or variable is defined. Returns the file path plus metadata (exports, imports, dependencies, LOC).

**Input:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `name` | string | yes | Exact export name to find (function, class, type, variable, component) |

**Example request:**
```json
{"name": "createStore"}
```

**Example response:**
```
src/store/index.ts
  exports: createStore, configureStore, StoreConfig
  imports: redux, immer
  dependencies: ../config
  loc: 89
```

### `fmm_list_exports`

Search or list exported symbols across the codebase. Use `pattern` for fuzzy discovery (e.g. `auth` matches `validateAuth`, `authMiddleware`). Use `file` to list a specific file's exports.

**Input:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `pattern` | string | no | Substring to match against export names (case-insensitive) |
| `file` | string | no | File path — returns all exports from this specific file |

### `fmm_file_info`

Get a file's structural profile from the index: exports, imports, dependencies, LOC. Same data as the file's `.fmm` sidecar, but from the pre-built index.

**Input:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `file` | string | yes | File path to inspect |

### `fmm_dependency_graph`

Get a file's dependency graph: upstream dependencies (what it imports) and downstream dependents (what would break if it changes). Use for impact analysis and blast radius estimation.

**Input:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `file` | string | yes | File path to analyze |

**Example response:**
```
src/auth.ts dependency graph:

Upstream (this file depends on):
  src/config.ts
  src/db.ts

Downstream (depends on this file):
  src/routes/login.ts
  src/routes/register.ts
  src/middleware/session.ts
```

### `fmm_search`

Search files by structural criteria: exported symbol, imported package, local dependency, or LOC range. Filters combine with AND logic.

**Input:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `export` | string | no | Find the file that exports this symbol (exact match) |
| `imports` | string | no | Find all files that import this package/module (substring match) |
| `depends_on` | string | no | Find all files that depend on this local path |
| `min_loc` | integer | no | Minimum lines of code |
| `max_loc` | integer | no | Maximum lines of code |

## Legacy aliases

These aliases are supported for backward compatibility:

| Alias | Maps to |
|-------|---------|
| `fmm_find_export` | `fmm_lookup_export` |
| `fmm_find_symbol` | `fmm_lookup_export` |
| `fmm_file_metadata` | `fmm_file_info` |
| `fmm_analyze_dependencies` | `fmm_dependency_graph` |

## Protocol

- **Version:** 2024-11-05
- **Transport:** stdio
- **Max response size:** 10,240 bytes (truncated with line count summary if exceeded)

---

